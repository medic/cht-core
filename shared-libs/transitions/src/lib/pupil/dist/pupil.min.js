/*! pupil 1.1.2 2013-09-15 */
!function(){var a={},b=function(b){a[b]={name:b,toString:function(){return b}}};b("Block"),b("Func"),b("Ternary"),b("LogicalAnd"),b("LogicalOr"),b("LogicalNot"),"undefined"!=typeof module?module.exports=a:(window.pupil=window.pupil||{},window.pupil.entities=a)}(),function(){var a=function(a){this.tokens=a};a.prototype.tokenize=function(a){var b,c=a.split(""),d=[],e=this.tokens,f=function(a,b){d.push({name:a,data:b||null})},g=new RegExp("^\\s+$"),h="",i=!1,j=!1,k=[],l=!1,m=!1,n=null;for(b=0;b<c.length;b++){var o=c[b],p=c[b+1],q=!1,r=!1;if(i=!1,k=[],l=!1,j?(j=!1,i=!0):o===n?r=!0:m?i=!0:'"'===o||"'"===o?q=!0:"\\"==o?(j=!0,l=!0):","==o?k.push([e.Comma]):":"==o?k.push([e.Colon]):"?"==o?k.push([e.QuestionMark]):"&"==o&&"&"==p?(k.push([e.LogicalAnd]),b++):"|"==o&&"|"==p?(k.push([e.LogicalOr]),b++):"!"==o?k.push([e.LogicalNot]):"("==o?k.push([e.BracketOpen]):")"==o?k.push([e.BracketClose]):g.test(o)?l=!0:i=!0,i&&(h+=o),b==c.length-1&&(i=!1),i||l||""===h||(m?k.unshift([e.String,h]):!isNaN(parseFloat(h,10))&&isFinite(h)?k.unshift([e.Number,h]):k.unshift([e.Identifier,h]),h=""),q&&(m=!0,n=o),r&&(m=!1,n=null),k.length>0)for(var s=0;s<k.length;s++)f(k[s][0],k[s][1])}return d},"undefined"!=typeof module?module.exports={create:function(b){return new a(b)}}:(window.pupil=window.pupil||{},window.pupil.lexer=a)}(),function(){var a=function(a){return{type:a,sub:[],funcName:"",funcArgs:[],conditions:[],ifThen:null,ifElse:null}},b=function(a,b){this.message=a,this.pos=b},c=function(a,b){this.tokens=a,this.entities=b};c.prototype.parse=function(c){var d=this.tokens,e=this.entities,f=a(e.Block),g=[f],h=g[g.length-1],i=null,j=!0,k={identifier:0,string:0,number:0,logicalOp:0,negator:0,funcArgsStart:0,funcArgsEnd:0,argSeparator:0,blockStart:0,blockEnd:0,ternaryThen:0,ternaryElse:0},l=function(a){for(var b in k)k[b]=0;for(var c=0;c<a.length;c++)"undefined"!=typeof k[a[c]]&&(k[a[c]]=1)};l(["identifier","negator","blockStart"]);for(var m=0;m<c.length;m++){var n=c[m],o=[],p=!1,q=!1,r=!1;if(n.name==d.String||n.name==d.Number){if(!k.string)throw new b("Unexpected string",m);if(!k.number)throw new b("Unexpected number",m);j=!1,n.name==d.String?i.funcArgs.push(n.data.toString()):i.funcArgs.push(parseFloat(n.data,10)),l(["argSeparator","funcArgsEnd"])}else if(n.name==d.Identifier){if(!k.identifier)throw new b("Unexpected identifier",m);j=!1,i=a(e.Func),i.funcName=n.data,l(["logicalOp","funcArgsStart","blockEnd","ternaryThen","ternaryElse"])}else if(n.name==d.QuestionMark){if(!k.ternaryThen)throw new b("Unexpected ternary 'then'");var s=a(e.Ternary);s.conditions=h.sub,h.sub=[s],g.push(s),h=g[g.length-1],l(["identifier","blockStart","negator"])}else if(n.name==d.Colon){if(!k.ternaryElse)throw new b("Unexpected ternary 'else'");h.ifThen=h.sub,h.sub=[],l(["identifier","blockStart","negator"])}else if(n.name==d.Comma){if(!k.argSeparator)throw new b("Unexpected function argument separator",m);j=!1,l(["string","number","funcArgsEnd"])}else if(n.name==d.LogicalAnd){if(!k.logicalOp)throw new b("Unexpected logical AND",m);o.push(a(e.LogicalAnd)),j=!0,l(["identifier","negator","blockStart"])}else if(n.name==d.LogicalOr){if(!k.logicalOp)throw new b("Unexpected logical OR",m);o.push(a(e.LogicalOr)),j=!0,l(["identifier","blockStart","negator"])}else if(n.name==d.LogicalNot){if(!k.negator)throw new b("Unexpected logical NOT",m);o.push(a(e.LogicalNot)),l(["identifier","blockStart"])}else if(n.name==d.BracketOpen)if(i&&k.funcArgsStart)j=!1,l(["string","number","funcArgsEnd"]);else{if(!k.blockStart)throw new b("Unexpected opening bracket",m);p=!0,j=!0,l(["identifier","blockStart","blockEnd","negator"])}else if(n.name==d.BracketClose)if(i&&k.funcArgsEnd)j=!0,l(["logicalOp","blockEnd","ternaryThen","ternaryElse"]);else{if(!k.blockEnd)throw new b("Unexpected closing bracket",m);q=!0,j=!0,flushTernaryElse=!0,flushTernary=!0,l(["logicalOp","blockEnd","ternaryThen","ternaryElse"])}if(m==c.length-1&&(j=!0,r=!0),j&&i&&(o.unshift(i),i=null),o.length>0)for(var t=0;t<o.length;t++)h.sub.push(o[t]);if(p){var u=a(e.Block);g.push(u),h.sub.push(u),h=g[g.length-1]}if((r||q)&&h.type==e.Ternary&&(null!==h.ifThen?h.ifElse=h.sub:h.ifThen=h.sub,h.sub=[],g.pop(),h=g[g.length-1]),q){if(1===g.length)throw new b("Can't close the root block.",m);g.pop(),h=g[g.length-1]}}if(g.length>1)throw new b("All blocks weren't closed.");return[f]},"undefined"!=typeof module?module.exports={create:function(a,b){return new c(a,b)}}:(window.pupil=window.pupil||{},window.pupil.parser=c)}(),function(){var a=null,b=null,c=null,d=null,e=null,f=null,g=null,h=!1,i={},j=function(){"undefined"!=typeof module?(a=require("./tokens.js"),b=require("./entities.js"),c=require("./validator_functions.js"),d=require("./lexer.js").create(a),e=require("./parser.js").create(a,b),f=require("./validator.js").create(c,b),g=require("./validation_result.js")):(a=window.pupil.tokens,b=window.pupil.entities,c=window.pupil.validator_functions,d=new window.pupil.lexer(a),e=new window.pupil.parser(a,b),f=new window.pupil.validator(c,b),g=window.pupil.validation_result),h=!0},k=function(a,b){h||j(),c[a.toLowerCase()]=b},l=function(a,b){h||j();var c={};for(var k in b)c[k]=!0;for(var k in a){("undefined"==typeof b[k]||null===b[k])&&(b[k]="");var l,m,n=a[k];b[k],i[n]?m=i[n]:(l=d.tokenize(n),m=e.parse(l),i[n]=m),c[k]=f.validate(m,b,k)}return g.create(c)};"undefined"!=typeof module?module.exports={addFunction:k,validate:l}:(window.pupil=window.pupil||{},window.pupil.addFunction=k,window.pupil.validate=l)}(),function(){var a={},b=function(b){a[b]={name:b,toString:function(){return b}}};b("Identifier"),b("Comma"),b("Colon"),b("QuestionMark"),b("String"),b("Number"),b("LogicalAnd"),b("LogicalOr"),b("LogicalNot"),b("BracketOpen"),b("BracketClose"),"undefined"!=typeof module?module.exports=a:(window.pupil=window.pupil||{},window.pupil.tokens=a)}(),function(){var a=function(a){this.results=a};a.prototype.isValid=function(){for(var a in this.results)if(!this.results[a])return!1;return!0},a.prototype.hasErrors=function(){return!this.isValid()},a.prototype.errors=function(){var a=[];for(var b in this.results)this.results[b]||a.push(b);return a},a.prototype.fields=function(){return this.results};var b={create:function(b){return new a(b)}};"undefined"!=typeof module?module.exports=b:(window.pupil=window.pupil||{},window.pupil.validation_result=b)}(),function(){var a=function(a,b){this.validatorFunctions=a,this.entities=b};a.prototype.validate=function(a,b,c){if(null===a||"undefined"==typeof a)return!0;for(var d=this.validatorFunctions,e=this.entities,f=!0,g=1,h=!1,i=0;i<a.length;i++){var j=a[i],k=!0,l=!1;if(j.type==e.LogicalAnd)g=1;else if(j.type==e.LogicalOr)g=2;else if(j.type==e.LogicalNot)h=!0;else if(j.type==e.Func){for(var m=j.funcName.toLowerCase(),n=[],o=0;o<j.funcArgs.length;o++)n.push(j.funcArgs[o]);if("other"==m.substr(0,5)){m=m.substr(5);var p=n.shift();n.unshift(b[p])}else n.unshift(b[c]);n.unshift(b),k=d[m].apply(this,n),l=!0}else if(j.type==e.Block)k=this.validate(j.sub,b,c),l=!0;else if(j.type==e.Ternary){var q=this.validate(j.conditions,b,c);k=q?this.validate(j.ifThen,b,c):this.validate(j.ifElse,b,c),l=!0}l&&(h&&(k=!k,h=!1),f=1==g?f&&k:f||k,l=!1)}return f},"undefined"!=typeof module?module.exports={create:function(b,c){return new a(b,c)}}:(window.pupil=window.pupil||{},window.pupil.validator=a)}(),function(){var a={},b={alpha:new RegExp("^[a-zA-Z]+$"),alphanumeric:new RegExp("^[a-zA-Z0-9]+$"),email:new RegExp("^.*?@.*?\\..+$")};a={equals:function(a,b,c){return b==c},iequals:function(a,b,c){return b.toLowerCase()==c.toLowerCase()},sequals:function(a,b,c){return b===c},siequals:function(a,b,c){return b.toLowerCase()===c.toLowerCase()},lenmin:function(a,b,c){return b.length>=c},lenmax:function(a,b,c){return b.length<=c},lenequals:function(a,b,c){return b.toString().length==parseInt(c,10)},min:function(a,b,c){return parseFloat(b,10)>=c},max:function(a,b,c){return parseFloat(b,10)<=c},between:function(a,b,c,d){var e=parseFloat(b,10);return e>=c&&d>=e},"in":function(a,b){var c=Array.prototype.slice.call(arguments);c.shift(),c.shift();for(var d=c,e=0;e<d.length;e++)if(d[e]==b)return!0;return!1},required:function(a,b){return!!b},optional:function(){return!0},numeric:function(a,b){return!isNaN(parseFloat(b))&&isFinite(b)},alpha:function(a,c){return b.alpha.test(c)},alphanumeric:function(a,c){return b.alphanumeric.test(c)},email:function(a,c){return b.email.test(c)},regex:function(a,b,c,d){return d=d||"",new RegExp(c,d).test(b)},integer:function(a,b){return parseInt(b,10)==b},equalsto:function(a,b,c){return b==a[c]}},"undefined"!=typeof module?module.exports=a:(window.pupil=window.pupil||{},window.pupil.validator_functions=a)}();