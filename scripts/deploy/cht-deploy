#!/usr/bin/env node

import install from './src/install.js';
import fs from 'fs';

function validateArguments() {
    const args = process.argv.slice(2);
    if (args.length < 2 || args[0] !== '-f' || !args[1]) {
        console.error('No values file provided. Please specify a values file using -f <file>');
        process.exit(1);
    }
    return args;
}

function validateFileExists(filePath) {
    try {
        fs.accessSync(filePath);
    } catch (err) {
        console.error(`File not found: ${filePath}`);
        process.exit(1);
    }
}

async function runInstallScript(args) {
    try {
        const valuesFilePath = args[1];
        await install(valuesFilePath);
    } catch (err) {
        console.error('Error executing the install script:');
        console.error(err.message);
        process.exit(1);
    }
}

async function main() {
    const args = validateArguments();
    validateFileExists(args[1]);
    await runInstallScript(args);
}

main().catch((err) => {
    console.error('An error occurred:', err.message);
});
