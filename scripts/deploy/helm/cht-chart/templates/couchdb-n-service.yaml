{{- if .Values.couchdb.clusteredCouch_enabled }}
{{- range $i, $e := until (int .Values.clusteredCouch.noOfCouchDBNodes) }}
{{ $nodeNumber := add $i 1 }}
apiVersion: v1
kind: Service
metadata:
  labels:
    cht.service: couchdb-{{ $nodeNumber }}
  name: couchdb-{{ $nodeNumber }}
spec:
  ports:
    - name: couchdb{{ $nodeNumber }}-service
      port: 5984
      protocol: TCP
      targetPort: 5984
    - name: cluster-api
      port: 5986
      protocol: TCP
      targetPort: 5986
    - name: epmd
      port: 4369
      protocol: TCP
      targetPort: 4369
    - name: erlang
      port: 9100
      protocol: TCP
      targetPort: 9100
  selector:
    cht.service: couchdb-{{ $nodeNumber }}
status:
  loadBalancer: {}
--- #Don't remove the separator. We need this to separate yamls generated by the range command.
{{- end }}
{{- end }}
