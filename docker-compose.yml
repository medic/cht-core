version: '2'

networks:
  medic-net:
    driver: bridge

volumes:
  medic-data:
    external: false

services:
  couchdb:
    image: couchdb:2.2.0
    env_file: docker/couchdb/.couch-env
    container_name: couchdb
    restart: always
    volumes:
      - ./docker/couchdb/etc/local.ini:/opt/couchdb/etc/local.ini
      - medic-data:/opt/couchdb/data
    networks:
      - medic-net

  haproxy:
    build: ./docker/haproxy
    container_name: haproxy
    ports:
      - 5984:5984
    depends_on:
      - couchdb
    networks:
      - medic-net
