{
    "name": "medic",
    "display_name": "Medic Mobile",
    "version": "2.6.0",
    "description": "Medic Mobile combines SMS messaging, data collection, and analytics for health workers and health systems in hard-to-reach areas with or without internet connectivity.",
    "long_description" : "Medic Mobile is a web based SMS data collection and analytics tool focused on community health care workers in rural environments. We help large health organizations collect and analyze data sent from health care workers using ordinary mobile phones.",
    "url": "https://github.com/medic/medic-webapp",
    "categories": ["health", "sms"],
    "icons": {
        "16": "static/img/promo/icon_16.png",
        "48": "static/img/promo/icon_48.png",
        "96": "static/img/promo/icon_96.png",
        "128": "static/img/promo/icon_128.png"
    },
    "promo_images": {
        "small": "static/img/promo/promo_small.png"
    },
    "screenshots": [
        "static/img/promo/promo-messages.png",
        "static/img/promo/promo-reports.png",
        "static/img/promo/promo-analytics.png"
    ],
    "loglevel": "info",
    "load": "lib/app",
    "modules": ["lib"],
    "attachments": [
        "static/audio",
        "static/dist",
        "static/fonts",
        "static/img",
        "templates/inbox.html",
        "ddocs/compiled"
    ],
    "changelog": "Changes.md",
    "node_module_folders" : "api,sentinel",
    "dependencies": {
        "modules": null,
        "properties": null,
        "attachments": null,
        "settings": null,
        "libphonenumber": null,
        "kujua-sms": null,
        "kujua-utils": null,
        "kujua-reporting": null,
        "cookies": null,
        "kanso-app-settings": null,
        "app-settings": ">=0.0.2",
        "url": null,
        "querystring": null,
        "duality": null,
        "kanso-gardener": null
    },
    "postprocessors": {
        "bundle_templates": "scripts/bundle_templates"
    },
    "status_path": "/status",
    "user_data": {
        "db_prefix": false,
        "available_roles" : ["kujua_user","national_admin","district_admin","kujua_gateway","data_entry"],
        "schema": {
            "descripton": "Medic Mobile",
            "type": "object",
            "properties": {
                "facility_id": {
                    "title": "Facility Id",
                    "type": "string",
                    "je:hint": "autocompleteSelect2",
                    "je:url" : "/{{dbname}}/_design/{{ddoc}}/_rewrite/facilities_select2.json"
                },
                "phone": {
                    "title": "Phone",
                    "type": "string"
                },
                "locale": {
                    "title": "Locale",
                    "type": "string",
                    "description": "Default tries to use best option according to browser settings, you can override that here.",
                    "default": "en"
                }
            }
        }
    },
    "settings_schema" : {
        "description": "Medic Mobile Settings",
        "type": "object",
        "properties": {
            "locales": {
                "title": "Locales",
                "description": "A list of available locales with a unique short code (egs: 'en', 'fr') and a human readable name of the locale (egs: 'English', 'French')",
                "type": "array",
                "items": {
                    "type": "object",
                    "properties": {
                        "code": {
                            "type": "string",
                            "title": "Code",
                            "default": ""
                        },
                        "name": {
                            "type": "string",
                            "title": "Display Name",
                            "default": ""
                        }
                    }
                },
                "default": [
                    {
                        "code": "en",
                        "name": "English"
                    },
                    {
                        "code": "es",
                        "name": "Español (Spanish)"
                    },
                    {
                        "code": "fr",
                        "name": "Français (French)"
                    },
                    {
                        "code": "ne",
                        "name": "नेपाली (Nepali)"
                    },
                    {
                        "code": "sw",
                        "name": "Kiswahili (Swahili)"
                    },
                    {
                        "code": "hi",
                        "name": "हिन्दी (Hindi)"
                    }
                ]
            },
            "locale": {
                "title": "Default Locale For Website",
                "type": "string",
                "description": "The code of the default locale for users logging in to the website. Can be overridden in user settings. Must be one of the codes specified in Locales above.",
                "default": "en"
            },
            "locale_outgoing": {
                "title": "Default Locale For Outgoing Messages",
                "type": "string",
                "description": "The code of the default locale for outgoing messages. Must be one of the codes specified in Locales above.",
                "default": "en"
            },
            "muvuku_webapp_url": {
                "type": "string",
                "title": "Medic Reporter URL",
                "default": "/medic-reporter/_design/medic-reporter/_rewrite/?_embed_mode=2#/examples.json"
            },
            "date_format": {
                "type": "string",
                "title": "Date Format",
                "default": "DD-MMM-YYYY",
                "description": "Format used to display dates."
            },
            "reported_date_format": {
                "type": "string",
                "title": "DateTime Format",
                "default": "DD-MMM-YYYY HH:mm:ss",
                "description": "Format used to display dates and times."
            },
            "forms_only_mode": {
                "type": "boolean",
                "title": "Only Expect Forms",
                "default": false
            },
            "default_responses": {
                "title": "Auto-replies",
                "type": "object",
                "properties": {
                    "start_date": {
                        "type": "string",
                        "title": "Start Date",
                        "default": "",
                        "description": "Auto-replies are added to messages received after this date.  If left empty auto-replies are not added.  Use the format YYYY-MM-DD to define the date, for example 2014-03-27.  This setting only applies to unstructured messages, not forms.  Error replies are added when a message is empty or a form is not found and we are in forms only mode.  Otherwise you will get a default reply. All reply messages are generated based on translation and locale settings.",
                        "pattern": "(^[0-9]{4}\\-[0-9]{2}\\-[0-9]{2}\\s*$|^\\s*$)"
                    }
                }
            },
            "district_admins_access_unallocated_messages": {
                "type": "boolean",
                "title": "Allow District Admins To View Unallocated Messages",
                "default": false,
                "description": "If ticked, district administrators will be able to view messages with no allocated facility as well as messages from their district."
            },
            "default_country_code": {
                "type": "integer",
                "title": "Default Country Code",
                "description": "Messages without a country code will be assigned this country code.",
                "default": 1
            },
            "gateway_number": {
                "type": "string",
                "title": "Gateway Number",
                "description": "This is the number where mobile reporters should send their reports. It is also the number they will receive messages from.  Auto-replies will not be sent to this number to avoid message loops."
            },
            "outgoing_phone_replace": {
                "title": "Outgoing Phone Replacement",
                "type": "object",
                "properties": {
                    "match": {
                        "type": "string",
                        "title": "Match",
                        "description": "The prefix to match.  e.g. +997"
                    },
                    "replace": {
                        "type": "string",
                        "title": "Replace with",
                        "description": "The value to replace the match with"
                    }
                }
            },
            "outgoing_phone_filters": {
                "title": "Outgoing Phone Filters",
                "type": "array",
                "description": "These filters are applied to every phone number on an outgoing message.  This can be useful if your incoming phone number and outgoing phone number formats are slightly different.",
                "items": {
                    "type": "object",
                    "properties": {
                        "match": {
                            "type": "string",
                            "title": "Match",
                            "description": "A regular expression used to match a phone number.  e.g. \\+997"
                        },
                        "replace": {
                            "type": "string",
                            "title": "Replace with",
                            "description": "Replace the match with this value."
                        }
                    }
                }
            },
            "schedule_morning_hours" : {
                "title": "Scheduled Message Morning Hours",
                "description": "Only send messages on or after this hour.",
                "type": "integer",
                "default": 0
            },
            "schedule_morning_minutes" : {
                "title": "Scheduled Message Morning Minutes",
                "description": "Only send messages on or after this minute.",
                "type": "integer",
                "default": 0
            },
            "schedule_evening_hours" : {
                "title": "Scheduled Message Evening Hours",
                "description": "Only send messages on or before this hour.",
                "type": "integer",
                "default": 23
            },
            "schedule_evening_minutes" : {
                "title": "Scheduled Message Evening Minutes",
                "description": "Only send messages on or before this minute.",
                "type": "integer",
                "default": 0
            },
            "synthetic_date" : {
                "title": "Synthetic date",
                "description": "Only use this if you are testing message scheduling and want to simulate a specific date. e.g. 201304121200",
                "type": "string",
                "pattern": "(^[0-9]{12}$|^$)"
            },
            "id_format": {
                "title": "Patient ID Format",
                "type": "string",
                "default": "1111",
                "description": "Length of generated numerical identifiers. Note, an extra check digit is always used, so the default value (1111) generates a length of 5."
            },
            "contact_display_short": {
                "type": "string",
                "title": "Short Contact Display",
                "description": "How to render the contact name in short format? e.g. clinic.name, clinic.contact.name, clinic.parent.name",
                "default": "clinic.name"
            },
            "statistics_submission": {
                "type": "string",
                "title": "Anonymous Statistics Submission",
                "description": "Whether and how to submit anonymous statistics. Valid values: 'none', 'web', 'sms', 'both'",
                "default": "none"
            },
            "statistics_submission_number": {
                "type": "string",
                "title": "Anonymous Statistics Submission SMS Number",
                "description": "The phone number to send Anonymous Statistics to."
            },
            "kujua-reporting": {
                "title": "Scheduled Reports",
                "type": "array",
                "description": "The forms to include in reporting rates stats.",
                "items": {
                    "type": "object",
                    "properties": {
                        "code": {
                            "type": "string",
                            "title": "Form Code",
                            "description": "e.g. ZDIS"
                        },
                        "reporting_freq": {
                            "type": "string",
                            "title": "Frequency",
                            "default": "weekly",
                            "enum": [
                                "weekly",
                                "monthly"
                            ]
                        }
                    }
                },
                "default": []
            },
            "anc_forms": {
                "title": "ANC Reports",
                "type": "object",
                "properties": {
                    "registration": {
                        "type": "string",
                        "title": "Pregnancy Registration Form Code",
                        "description": "e.g. R"
                    },
                    "registrationLmp": {
                        "type": "string",
                        "title": "Pregnancy Registration LMP Form Code",
                        "description": "e.g. P"
                    },
                    "visit": {
                        "type": "string",
                        "title": "Completed ANC Visit Form Code",
                        "description": "e.g. V"
                    },
                    "delivery": {
                        "type": "string",
                        "title": "Delivery Report Form Code",
                        "description": "e.g. D"
                    },
                    "flag": {
                        "type": "string",
                        "title": "Flag Pregnancy Form Code",
                        "description": "e.g. F"
                    }
                }
            },
            "permissions": {
                "title": "Permissions",
                "type": "array",
                "items": {
                    "type": "object",
                    "properties": {
                        "name": {
                            "type": "string",
                            "title": "Permission"
                        },
                        "roles": {
                            "title": "Roles",
                            "type": "array",
                            "default": [],
                            "items": {
                                "type": "string"
                            }
                        }
                    }
                }
            },
            "alerts": {
                "title": "Alerts",
                "type": "array",
                "items": {
                    "type": "object",
                    "properties": {
                        "form": {
                            "type": "string",
                            "title": "Form Code"
                        },
                        "condition": {
                            "type": "string",
                            "je:hint": "textarea",
                            "je:textarea": {
                                "rows": 2
                            },
                            "title": "Condition To Send Alerts",
                            "description": "Alert will be sent when condition is true. Build condition using the notation `form_code(reports_ago).field_id`. E.g.: The following can be used to send an alert if the value of `s1_avail` in form `STCK` falls below the three month average of `s1_used`: \"STCK(0).s1_avail < (STCK(0).s1_used + STCK(1).s1_used + STCK(2).s1_used ) / 3\"."
                        },
                        "message": {
                            "type": "string",
                            "je:hint": "textarea",
                            "je:textarea": {
                                "rows": 2
                            },
                            "title": "Alert Text",
                            "description": "Text that will be sent out in the alert. Variables names can be used. E.g.: {{clinic.name}}, {{s1_name}}."
                        },
                        "recipient": {
                            "type": "string",
                            "title": "Send Alerts To",
                            "description": "The email or phone number to receive alerts. Can also use variable name to receive alert. E.g.: reporting_unit, parent, grandparent, name@ngo.org, +15559870000"
                        }
                    }
                }
            },
            "reminders": {
                "title": "Scheduled Report Reminders",
                "type": "array",
                "items": {
                    "type": "object",
                    "properties": {
                        "form": {
                            "type": "string",
                            "title": "Reminder Form Code",
                            "description": "What form is this reminder for?  e.g. ZDIS"
                        },
                        "text_expression": {
                            "type": "string",
                            "title": "Reminder Text Configuration",
                            "description": "A text expression definition of the schedule.  See http://bunkat.github.io/later/parsers.html#text e.g. at 9am on Monday"
                        },
                        "cron": {
                            "type": "string",
                            "title": "Reminder Cron Configuration",
                            "description": "A cron definition of the schedule. Optional, a text expression will override this.  e.g. weekly on Monday at 9am: '0 9 * * 1'"
                        },
                        "mute_after_form_for": {
                            "type": "string",
                            "title": "Mute Reminders For",
                            "description": "After receiving a form, how long to mute reminders for.  Supported units: years, months, weeks, days, hours, minutes. e.g. 5 days"
                        },
                        "message": {
                            "type": "string",
                            "title": "Reminder Text",
                            "description": "Message to be sent.  The following strings will be substituted into the message: {{week}}, {{year}} and {{form}}.",
                            "je:hint": "textarea",
                            "je:textarea": {
                                "rows": 2
                            }
                        }
                    }
                }
            },
            "registrations": {
                "title": "Registrations",
                "type": "array",
                "items": {
                    "type": "object",
                    "properties": {
                        "form": {
                            "type": "string",
                            "title": "Registration Form",
                            "description": "Form code of a registration form. e.g. ANCR"
                        },
                        "fields": {
                            "title": "Fields",
                            "type": "array",
                            "description": "Available field names for use in validations",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "field_name": {
                                        "type": "string",
                                        "title": "Field Name"
                                    },
                                    "title": {
                                        "type": "string",
                                        "title": "Display Name"
                                    }
                                }
                            },
                            "default": []
                        },
                        "help": {
                            "title": "Help",
                            "type": "string",
                            "description": "Instructions explaining how to use this form, including description and form submission examples in <a href=\"http://daringfireball.net/projects/markdown/syntax\">Markdown format</a>. e.g. Register for this message workflow by sending an SMS with the following format: `ANCR <patientname>`.\n\nFor example, to register \"Maria Soleil\" you would send: `ANCR Maria Soleil`",
                            "je:hint": "textarea",
                            "je:textarea": {
                                "rows": 4
                            }
                        },
                        "events": {
                            "type": "array",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "name": {
                                        "type": "string",
                                        "title": "Event Name",
                                        "default": "on_create",
                                        "enum": ["on_create"],
                                        "je:hint": "enumlabels",
                                        "je:enumlabels": {
                                            "on_create": "On Create"
                                        }
                                    },
                                    "trigger": {
                                        "type": "string",
                                        "title": "Trigger",
                                        "default": "assign_schedule",
                                        "description": "When form is received trigger actions like enrolling in schedule.",
                                        "enum": ["assign_schedule", "add_patient_id", "add_expected_date", "add_birth_date"],
                                        "je:hint": "enumlabels",
                                        "je:enumlabels": {
                                            "assign_schedule": "Assign a schedule",
                                            "add_patient_id": "Add Patient ID",
                                            "add_expected_date": "Add Expected Date",
                                            "add_birth_date": "Add Birth Date"
                                        }
                                    },
                                    "params": {
                                        "type": "string",
                                        "title": "Parameters",
                                        "description": "i.e. if assigning a schedule provide the name."
                                    },
                                    "bool_expr": {
                                        "type": "string",
                                        "title": "Boolean expression",
                                        "description": "If this expression evaluates to false the trigger will be skipped."
                                    }
                                }
                            },
                            "default": []
                        },
                        "validations": {
                            "type": "object",
                            "properties": {
                                "join_responses": {
                                    "title": "Join Validation Responses",
                                    "type": "boolean",
                                    "description": "By default we send one validation response at a time.  Use this option to join or concatenate all validation response messages in one.  Note, like all outgoing messages it will be truncated at 160 characters."
                                },
                                "list": {
                                    "type": "array",
                                    "items": {
                                        "type": "object",
                                        "properties": {
                                            "property": {
                                                "type": "string",
                                                "title": "Property",
                                                "description": "The property on the JSON form to validate. e.g. patient_name"
                                            },
                                            "rule": {
                                                "type": "string",
                                                "title": "Validation Rule",
                                                "description": "The <a href='/medic/_design/medic/_rewrite/#/help/validation' rel='external'>validation rule</a>. Backslashes must be double escaped. e.g. lenMin(5) && lenMax(50)"
                                            },
                                            "message": {
                                                "type": "array",
                                                "title": "Response Message",
                                                "description": "The response when validation fails. <a href='/medic/_design/medic/_rewrite/#/help/messages' rel='external'>Mustache</a> templating is supported.",
                                                "items": {
                                                    "type": "object",
                                                    "properties": {
                                                        "content": {
                                                            "type": "string",
                                                            "title": "Message Content",
                                                            "description": "e.g. '{{patient_name}}' is not a valid patient name. Please submit a patient name between 5 and 50 characters.",
                                                            "je:hint": "textarea",
                                                            "je:textarea": {
                                                                "rows": 2
                                                            }
                                                        },
                                                        "locale": {
                                                            "title": "Locale",
                                                            "type": "string",
                                                            "description": "Set the locale if you need to support responses in multiple languages. e.g. en"
                                                        }
                                                    }
                                                },
                                                "default": []
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "messages": {
                            "type": "array",
                            "title": "Response Messages",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "message": {
                                        "type": "array",
                                        "title": "Message",
                                        "description": "<a href='/medic/_design/medic/_rewrite/#/help/messages' rel='external'>Mustache</a> templating is supported",
                                        "items": {
                                            "type": "object",
                                            "properties": {
                                                "content": {
                                                    "type": "string",
                                                    "title": "Message Content",
                                                    "je:hint": "textarea",
                                                    "je:textarea": {
                                                        "rows": 2
                                                    }
                                                },
                                                "locale": {
                                                    "title": "Locale",
                                                    "type": "string",
                                                    "description": "Set the locale if you need to support responses in multiple languages. e.g. en"
                                                }
                                            }
                                        },
                                        "default": []
                                    },
                                    "recipient": {
                                        "type": "string",
                                        "title": "Recipient",
                                        "description": "Contact to recieve the message. Use a field name on registration form or one of the following to reference the facility: reporting_unit, parent, grandparent. e.g. reporting_unit"
                                    }
                                }
                            },
                            "default": []
                        }
                    }
                }
            },
            "patient_reports": {
                "title": "Patient Reports",
                "type": "array",
                "items": {
                    "type": "object",
                    "properties": {
                        "form": {
                            "type": "string",
                            "title": "Report Form",
                            "description": "Form code of the report. e.g. ANCV"
                        },
                        "name": {
                            "type": "string",
                            "title": "Display Name e.g. Visits"
                        },
                        "format": {
                            "type": "string",
                            "title": "Expected Format e.g. V <patientid>"
                        },
                        "silence_type": {
                            "type": "string",
                            "title": "Schedule Name",
                            "description": "Name of reminder schedule(s) to clear after receiving this report.  Name needs to match exactly, e.g. ANC Reminders.  If you need to support clearing multiple schedules then separate the names with commas."
                        },
                        "silence_for": {
                            "type": "string",
                            "title": "Silence Window",
                            "description": "The length of time used to find the next reminder group to clear.  Leave blank to clear all reminder groups.  Supported units: years, months, weeks, days, hours, minutes. e.g. 25 days"
                        },
                        "fields": {
                            "title": "Fields",
                            "type": "array",
                            "description": "Available field names for use in validations",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "field_name": {
                                        "type": "string",
                                        "title": "Field Name"
                                    },
                                    "title": {
                                        "type": "string",
                                        "title": "Display Name"
                                    }
                                }
                            },
                            "default": []
                        },
                        "validations": {
                            "type": "object",
                            "properties": {
                                "join_responses": {
                                    "title": "Join Validation Responses",
                                    "type": "boolean",
                                    "description": "By default we send one validation response at a time.  Use this option to join or concatenate all validation response messages in one.  Note, like all outgoing messages it will be truncated at 160 characters."
                                },
                                "list": {
                                    "type": "array",
                                    "items": {
                                        "type": "object",
                                        "properties": {
                                            "property": {
                                                "type": "string",
                                                "title": "Property",
                                                "description": "The property on the JSON form to validate. e.g. patient_id"
                                            },
                                            "rule": {
                                                "type": "string",
                                                "title": "Validation Rule",
                                                "description": "The <a href='/medic/_design/medic/_rewrite/#/help/validation' rel='external'>validation rule</a>. Backslashes must be double escaped. e.g. regex('[0-9]{5}')"
                                            },
                                            "message": {
                                                "title": "Response Message",
                                                "type": "array",
                                                "description": "The response when validation fails. <a href='/medic/_design/medic/_rewrite/#/help/messages' rel='external'>Mustache</a> templating is supported.",
                                                "items": {
                                                    "type": "object",
                                                    "properties": {
                                                        "content": {
                                                            "type": "string",
                                                            "title": "Message Content",
                                                            "description": "e.g. '{{patient_id}}' is not a valid.",
                                                            "je:hint": "textarea",
                                                            "je:textarea": {
                                                                "rows": 2
                                                            }
                                                        },
                                                        "locale": {
                                                            "title": "Locale",
                                                            "type": "string",
                                                            "description": "e.g. en"
                                                        }
                                                    }
                                                },
                                                "default": []
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "messages": {
                            "type": "array",
                            "title": "Response Messages",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "message": {
										"type": "array",
                                        "title": "Message Text",
                                        "description": "<a href='/medic/_design/medic/_rewrite/#/help/messages' rel='external'>Mustache</a> templating is supported",
                                        "items": {
                                            "type": "object",
                                            "properties": {
                                                "content": {
                                                    "type": "string",
                                                    "title": "Message Content",
                                                    "description": "e.g. '{{patient_id}}' is not a valid.",
                                                    "je:hint": "textarea",
                                                    "je:textarea": {
                                                        "rows": 2
                                                    }
                                                },
                                                "locale": {
                                                    "title": "Locale",
                                                    "type": "string",
                                                    "description": "e.g. en"
                                                }
                                            }
                                        },
                                        "default": []
                                    },
                                    "event_type": {
                                        "type": "string",
                                        "title": "Event Type",
                                        "description": "What should trigger this message?",
                                        "default": "report_accepted",
                                        "enum": [
                                            "report_accepted",
                                            "registration_not_found"
                                        ],
                                        "je:hint": "enumlabels",
                                        "je:enumlabels": {
                                            "report_accepted": "Report Accepted",
                                            "registration_not_found": "Registration Not Found"
                                        }
                                    },
                                    "recipient": {
                                        "type": "string",
                                        "title": "Recipient",
                                        "description": "Contact to recieve the message. Use a field name on registration form or one of the following to reference the facility: reporting_unit, parent, grandparent. e.g. reporting_unit"
                                    }
                                }
                            },
                            "default": []
                        }
                    }
                },
                "default": []
            },
            "schedules": {
                "title": "Schedules",
                "type": "array",
                "items": {
                    "type": "object",
                    "properties": {
                        "name": {
                            "type": "string",
                            "title": "Name",
                            "description": "A unique name to define this schedule. e.g. ANC Reminders"
                        },
                        "summary": {
                            "type": "string",
                            "title": "Summary",
                            "description": "A brief summary of this schedule"
                        },
                        "description": {
                            "type": "string",
                            "title": "Description",
                            "description": "A complete description of this schedule in <a href=\"http://daringfireball.net/projects/markdown/syntax\">markdown format</a>",
                            "je:hint": "textarea",
                            "je:textarea": {
                                "rows": 2
                            }
                        },
                        "start_from": {
                            "type": "string",
                            "title": "Timestamp Property Name",
                            "description": "A timestamp or date property on the record that is used to calculate when messages are sent. e.g. lmp_date.  Use reported_date if you want to reference the date and time the report was received."
                        },
                        "messages": {
                            "type": "array",
                            "title": "Messages",
                            "description": "<a href='/medic/_design/medic/_rewrite/#/help/messages' rel='external'>Mustache</a> templating is supported",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "message": {
                                        "type": "array",
                                        "items": {
                                            "type": "object",
                                            "properties": {
                                                "content": {
                                                    "type": "string",
                                                    "title": "Message Content",
                                                    "je:hint": "textarea",
                                                    "je:textarea": {
                                                        "rows": 2
                                                    }
                                                },
                                                "locale": {
                                                    "title": "Locale",
                                                    "type": "string",
                                                    "description": "Set the locale if you need to support responses in multiple languages. e.g. en"
                                                }
                                            }
                                        },
                                        "default": []
                                    },
                                    "group": {
                                        "type": "integer",
                                        "title": "Message Group Number",
                                        "default": 1,
                                        "description": "You can group reminders together by assigning a group number so they can be cleared in batches. e.g. 1"
                                    },
                                    "offset": {
                                        "type": "string",
                                        "title": "Send Message After",
                                        "description": "This value is added to the timestamp property value to determine when to send the message.  Supported units: years, months, weeks, days, hours, minutes. e.g. 5 days"
                                    },
                                    "send_day": {
                                        "type": "string",
                                        "title": "Send Day",
                                        "default": "monday",
                                        "description": "Optionally specify the nearest day to offset.",
                                        "enum": ["", "monday", "tuesday", "wednesday", "thursday", "friday", "saturday", "sunday"],
                                        "je:hint": "enumlabels",
                                        "je:enumlabels": {
                                            "": "",
                                            "monday": "Monday",
                                            "tuesday": "Tuesday",
                                            "wednesday": "Wednesday",
                                            "thursday": "Thursday",
                                            "friday": "Friday",
                                            "saturday": "Saturday",
                                            "sunday": "Sunday"
                                        }
                                    },
                                    "send_time": {
                                        "type": "string",
                                        "title": "Send Time",
                                        "description": "Specify time of day at which the message is to be sent. Ignored if blank. If timezone offset is not specfiied GMT will be used.  e.g. 20:30 +0300",
                                        "pattern": "(^[0-9]{1,2}:[0-9]{2}\\s*(\\s+[\\+\\-][0-9]{4})?$|^\\s*$)"
                                    },
                                    "recipient": {
                                        "type": "string",
                                        "title": "Recipient",
                                        "description": "Contact to recieve the message. Use a field name on registration form or one of the following to reference the facility: reporting_unit, parent, grandparent. e.g. reporting_unit"
                                    }
                                }
                            },
                            "default": []
                        }
                    }
                }
            },
            "notifications": {
                "title": "Notifications",
                "type": "object",
                "properties": {
                    "off_form": {
                        "type": "string",
                        "title": "Stop Notifications Form",
                        "description": "When receiving a form of this type, stop sending notifications. e.g. OFF"
                    },
                    "on_form": {
                        "type": "string",
                        "title": "Resume Notifications Form",
                        "description": "When receiving a form of this type, resume sending notifications. e.g. ON"
                    },
                    "confirm_deactivation": {
                        "type": "boolean",
                        "title": "Confirm Muting Notifications?",
                        "description": "Disable stopping of notification based on reports, requires administrator action."
                    },
                    "validations": {
                        "type": "object",
                        "properties": {
                            "join_responses": {
                                "title": "Join Validation Responses",
                                "type": "boolean",
                                "description": "By default we send one validation response at a time.  Use this option to join or concatenate all validation response messages in one.  Note, like all outgoing messages it will be truncated at 160 characters."
                            },
                            "list": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "properties": {
                                        "property": {
                                            "type": "string",
                                            "title": "Property",
                                            "description": "The property on the JSON form to validate. e.g. patient_id"
                                        },
                                        "rule": {
                                            "type": "string",
                                            "title": "Validation Rule",
                                            "description": "The <a href='/medic/_design/medic/_rewrite/#/help/validation' rel='external'>validation rule</a>. Backslashes must be double escaped. e.g. regex('[0-9]{5}')"
                                        },
                                        "message": {
                                            "title": "Response Message",
                                            "type": "array",
                                            "description": "The response when validation fails. <a href='/medic/_design/medic/_rewrite/#/help/messages' rel='external'>Mustache</a> templating is supported.",
                                            "items": {
                                                "type": "object",
                                                "properties": {
                                                    "content": {
                                                        "type": "string",
                                                        "title": "Message Content",
                                                        "description": "e.g. '{{patient_id}}' is not a valid.",
                                                        "je:hint": "textarea",
                                                        "je:textarea": {
                                                            "rows": 2
                                                        }
                                                    },
                                                    "locale": {
                                                        "title": "Locale",
                                                        "type": "string",
                                                        "description": "e.g. en"
                                                    }
                                                }
                                            },
                                            "default": []
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "messages": {
                        "type": "array",
                        "title": "Response Messages",
                        "items": {
                            "type": "object",
                            "properties": {
                                "message": {
                                    "type": "array",
                                    "title": "Message",
                                    "description": "<a href='/medic/_design/medic/_rewrite/#/help/messages' rel='external'>Mustache</a> templating is supported",
                                    "items": {
                                        "type": "object",
                                        "properties": {
                                            "content": {
                                                "type": "string",
                                                "title": "Message Content",
                                                "je:hint": "textarea",
                                                "je:textarea": {
                                                    "rows": 2
                                                }
                                            },
                                            "locale": {
                                                "title": "Locale",
                                                "type": "string",
                                                "description": "Set the locale if you need to support responses in multiple languages. e.g. en"
                                            }
                                        }
                                    },
                                    "default": []
                                },
                                "event_type": {
                                    "type": "string",
                                    "title": "Event Type",
                                    "description": "What should trigger this message?",
                                    "default": "patient_not_found",
                                    "enum": [
                                        "patient_not_found",
                                        "confirm_deactivation",
                                        "on_mute",
                                        "on_unmute"
                                    ],
                                    "je:hint": "enumlabels",
                                    "je:enumlabels": {
                                        "patient_not_found": "Patient Not Found",
                                        "confirm_deactivation": "Confirm Deactivation",
                                        "on_mute": "On Mute",
                                        "on_unmute": "On Unmute"
                                    }
                                },
                                "recipient": {
                                    "type": "string",
                                    "title": "Recipient",
                                    "description": "Contact to recieve the message. Use a field name on registration form or one of the following to reference the facility: reporting_unit, parent, grandparent. e.g. reporting_unit"
                                }
                            }
                        },
                        "default": []
                    }
                }
            },
            "tasks": {
                "title": "Task Generation",
                "type": "object",
                "properties": {
                    "rules": {
                        "title": "Rules",
                        "type": "string",
                        "description": "The <a href='https://github.com/C2FO/nools#dsl' rel='external'>Nools DSL</a> rule definition.",
                        "je:hint": "textarea",
                        "je:textarea": {
                            "rows": 20
                        }
                    },
                    "targets": {
                        "title": "Targets",
                        "type": "object",
                        "properties": {
                            "enabled": {
                                "title": "Enabled",
                                "type": "boolean"
                            },
                            "items": {
                                "title": "Items",
                                "type": "array",
                                "default": [],
                                "items": {
                                    "type": "object",
                                    "properties": {
                                        "id": {
                                            "title": "Unique identifier",
                                            "type": "string"
                                        },
                                        "type": {
                                            "title": "Type of statistic",
                                            "type": "string",
                                            "default": "count",
                                            "description": "Either 'count' or 'percent'"
                                        },
                                        "name": {
                                            "title": "Title",
                                            "type": "array",
                                            "items": {
                                                "type": "object",
                                                "properties": {
                                                    "content": {
                                                        "title": "Title Content",
                                                        "type": "string"
                                                    },
                                                    "locale": {
                                                        "title": "Locale",
                                                        "type": "string",
                                                        "default": "en"
                                                    }
                                                }
                                            }
                                        },
                                        "icon": {
                                            "title": "Icon",
                                            "type": "string",
                                            "description": "The id of the configured icon to use"
                                        },
                                        "goal": {
                                            "title": "Goal value",
                                            "type": "integer"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "schedules": {
                        "title": "Schedules",
                        "type": "array",
                        "default": [],
                        "items": {
                            "type": "object",
                            "properties": {
                                "name": {
                                    "title": "Name",
                                    "type": "string"
                                },
                                "events": {
                                    "title": "Events",
                                    "type": "array",
                                    "description": "The schedule of tasks to generate",
                                    "default": [],
                                    "items": {
                                        "type": "object",
                                        "properties": {
                                            "id": {
                                                "title": "Task ID",
                                                "type": "string"
                                            },
                                            "days": {
                                                "title": "Number of days after event that task is due",
                                                "type": "integer",
                                                "default": 356
                                            },
                                            "start": {
                                                "title": "Number of days before due date to show task",
                                                "type": "integer",
                                                "default": 356
                                            },
                                            "end": {
                                                "title": "Number of days after due date to show task",
                                                "type": "integer",
                                                "default": 356
                                            },
                                            "type": {
                                                "title": "Task type",
                                                "type": "string"
                                            },
                                            "title": {
                                                "title": "Title",
                                                "type": "array",
                                                "description": "<a href='/medic/_design/medic/_rewrite/#/help/messages' rel='external'>Mustache</a> templating is supported",
                                                "default": [],
                                                "items": {
                                                    "type": "object",
                                                    "properties": {
                                                        "content": {
                                                            "type": "string",
                                                            "title": "Title Content"
                                                        },
                                                        "locale": {
                                                            "title": "Locale",
                                                            "type": "string",
                                                            "default": "en"
                                                        }
                                                    }
                                                }
                                            },
                                            "description": {
                                                "title": "Description",
                                                "type": "array",
                                                "description": "<a href='/medic/_design/medic/_rewrite/#/help/messages' rel='external'>Mustache</a> templating is supported",
                                                "default": [],
                                                "items": {
                                                    "type": "object",
                                                    "properties": {
                                                        "content": {
                                                            "type": "string",
                                                            "title": "Description Content"
                                                        },
                                                        "locale": {
                                                            "title": "Locale",
                                                            "type": "string",
                                                            "default": "en"
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            },
            "translations": {
                "title": "Translations",
                "type": "array",
                "items": {
                    "type": "object",
                    "properties": {
                        "key": {
                            "type": "string",
                            "title": "Key",
                            "default": ""
                        },
                        "default": {
                            "type": "string",
                            "title": "Default",
                            "default": "",
                            "je:hint": "textarea",
                            "je:textarea": {
                                "rows": 2
                            }
                        },
                        "translations": {
                            "type": "array",
                            "title": "",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "locale": {
                                        "title": "Locale",
                                        "type": "string"
                                    },
                                    "content": {
                                        "title": "Translation",
                                        "type": "string",
                                        "je:hint": "textarea",
                                        "je:textarea": {
                                            "rows": 2
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}
